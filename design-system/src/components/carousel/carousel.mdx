import { Controls, Description, Meta, Primary, Source, Subtitle, Title, Unstyled } from "@storybook/addon-docs/blocks";
 
import * as CarouselStories from "./carousel.stories";
import carouselCss from "./carousel.css?raw";
import disclosureCss from "../disclosure/disclosure.css?raw";
import carouselJs from "./carousel.js?raw";

import carousel1024 from "./docs/carousel-1024.webp";
import carousel1024At2x from "./docs/carousel-1024@2x.webp";

<Meta of={CarouselStories} />

<Unstyled>
<div className="prose">

<Title />
<Subtitle />
<Description />

<div class="border-image">
  <img src={carousel1024} srcSet={`${carousel1024At2x} 2x`} alt="Normalカルーセルのスクリーンショット" width="768" height="320" style={{ maxWidth: '100%', height: 'auto' }} />
</div>

コンテナ幅が1024pxの地点にブレークポイントを持つカルーセルの作例です。各スライドは横幅696pxです。

コードスニペットにおける実際の動作は[NormalのStory](?path=/story/components-カルーセル--normal)を参照してください。

## 使い方

カルーセルコンポーネントをウェブページに導入するために必要なファイルや読み込み手順、利用時に注意すべきポイントをまとめます。

### 必要なファイルを読み込む

以下のファイルを読み込むことで、HTML内に記述する`<dads-carousel>`および`<dads-carousel-step-nav>`が正しく動作します。

- `carousel.css`  
- `disclosure.css`  
- `carousel.js`  

`<link>` / `<script>`タグで読み込んでも、ビルドツールなどでバンドルしても構いません。スクリプトを読み込む際は必ず、`<script type="module">`を使用しES Moduleとして読み込んでください。

### マークアップ

#### メインパネル

`.dads-carousel__panels`要素内の`dads-carousel__main`がメインパネルです。1枚目のスライドの情報を記述してください。

- リンクURL（ない場合は`href`属性ごと省略可）
- リンクターゲット（ない場合は`target`属性ごと省略可）
- 画像のURL
- 画像の代替テキスト
- 画像の幅および高さ

```html
<div class="dads-carousel__main" aria-live="polite" aria-atomic="true">
  <div class="dads-carousel__main-panel" data-js-main-panel>
    <a class="dads-carousel__main-link" href="{リンクURL}" target="{リンクターゲット}" data-js-main-link>
      <span class="dads-u-visually-hidden" data-js-main-label>スライド1</span>
      <div class="dads-carousel__image-container" data-js-main-images>
        <img src="{画像のURL}" alt="{画像の代替テキスト}" width="{画像の幅}" height="{画像の高さ}">
      </div>
    </a>
  </div>
</div>
```

#### ネクストパネル

`.dads-carousel__panels`要素内の`dads-carousel__next`がネクストパネルです。2枚目のスライドの情報を記述してください。

- 画像のURL
- 画像の幅および高さ
- **画像の`alt`属性は空にします**

```html
<p class="dads-carousel__next">
  <button type="button" data-js-next-button>
    <span class="dads-carousel__next-image-container" data-js-next-image-container>
      <img src="{画像のURL}" alt="" width="{画像の幅}" height="{画像の高さ}">
    </span>
    <span class="dads-carousel__next-image-label">次のスライド</span>
  </button>
</p>
```

#### ステップナビゲーション

`.dads-carousel__step-nav`要素内にスライド枚数分の`<li>`要素を記述してください。スライド番号を1から順番に記述します。

```html
<li role="presentation">
  <button class="dads-carousel__step dads-carousel__number" type="button" role="tab">
    <span class="dads-u-visually-hidden">スライド</span>{スライド番号}
  </button>
</li>
<li role="presentation">
  ...
</li>
...
```

#### すべてのスライド

`.dads-carousel__others-content`要素内の`<ul>`要素が全スライドのコンテナです。最初のスライドも含め、全てのスライドの情報を記述してください。

- スライド番号（**2箇所あり**）
- リンクURL（ない場合は`href`属性ごと省略可）
- リンクターゲット（ない場合は`target`属性ごと省略可）
- 画像のURL
- 画像の代替テキスト
- 画像の幅および高さ

```html
<li class="dads-carousel__panel-set" data-js-slide>
  <p class="dads-carousel__number dads-carousel__panel-number" aria-hidden="true">{スライド番号}</p>
  <div class="dads-carousel__main">
    <a class="dads-carousel__main-link" href="{リンクURL}" target="{リンクターゲット}">
      <span class="dads-u-visually-hidden">スライド{スライド番号}</span>
      <div class="dads-carousel__image-container">
        <img src="{画像のURL}" alt="{画像の代替テキスト}" width="{画像の幅}" height="{画像の高さ}">
      </div>
    </a>
  </div>
  <div class="dads-carousel__main-bg"><div data-js-bg-container></div></div>
</li>
<li class="dads-carousel__panel-set" data-js-slide>
  ...
</li>
```

## カスタマイズ

提供しているコードをカスタマイズする際は、以下の点に注意してください。また、下記に言及がなくても、[コンポーネントのガイドライン](https://design.digital.go.jp/dads/components/carousel/)に記載された内容を遵守してください。

### ブレークポイントを変更する

規定のブレークポイントはコンテナ幅を基準とした1024pxです。ブレークポイントを変更するにはHTMLおよびCSSを修正します。

HTMLは、`dads-carousel`カスタム要素の`breakpoint-rem`属性値を修正してください。数値の単位は`rem`です。

```html
<!-- 64（= 64rem = 1remが16pxのとき1024px）を任意の値に変更する -->
<dads-carousel breakpoint-rem="64" ...>
```

CSSは、`carousel.css`にある下記の記述を全て修正してください。

```css
/* 64rem（= 1remが16pxのとき1024px）を任意の値に変更する */
@container (min-width: 64rem) {
  ...
}
```

### 多言語化

カルーセルのコードスニペットには日本語のテキストが含まれています。コンポーネント全体を翻訳する場合、表示されているテキストのみならず、下記の非表示テキストも翻訳する必要があります。

- `.dads-carousel`要素の`aria-label`属性
- `.dads-carousel`要素の`data-js-unit`属性（※注）
- `.dads-carousel__main-link`要素に含まれるスライドの番号付き表記
- `.dads-carousel__step-nav`要素の`aria-label`属性
- `.dads-carousel__step`要素に含まれるスライドの番号付き表記
- `.dads-carousel__page-nav`要素に含まれる「次のスライド」および「前のスライド」

※注：スライドを番号付きで呼ぶために、数値に前置きする単位を指定します。例えば英語の場合は`"Slide "`などとします。

## CSS

### carousel.css

<Source code={carouselCss} language="css" />

### disclosure.css

<Source code={disclosureCss} language="css" />

## JavaScript

### carousel.js

<Source code={carouselJs} language="javascript" />

</div>
</Unstyled>
